- provide :title, "Tasks"
.row
  .col.s12.m8.offset-m2

    .card
      .card-content
        %p
          %strong Name:
          = @task.name
        %p
          %strong Description:
          = @task.description
        %p
          %strong Project:
          = link_to @task.project.name, @task.project
    - if user_signed_in?

      .card#card-timer
        .card-content
          %span.card-title
            .row
              .col.s6
                %span#timer

      = form_for [@task, @timer],
          html: { id: 'timer-form'}, remote: true do |f|
        = f.hidden_field :start, {id: 'time-start'}
        = f.hidden_field :finish, {id: 'time-finish'}

        %button.btn-floating.btn-large.waves-effect.waves-light{type: "submit"}
          %i.material-icons#timer-button play_arrow

      .card
        .card-content#timers-card
          %span.card-title Timers
          -@timers.each do |timer|
            .row
              .col.s3
                = timer.start.to_s( :db )
              .col.s3
                = timer.finish.to_s( :db )
              .col.s3
                = delta_time timer.start, timer.finish
              .col.s3
                = link_to [@task, timer], method: :delete, remote: true, class: "destroy-timer" do
                  %i.material-icons delete

    - if @task.comments.any?
      %h4 Comments
      - @task.comments.each do |comment|
        .card
          .card-content
            %span.card-title
              =comment.author
            %p
              = comment.body
            %p
              = link_to [@task, comment], method: :delete do
                %i.material-icons delete


    .card
      .card-content
        %span.card-title Add a Comment
        = form_for [@task, @task.comments.build] do |f|
          .input-field
            = f.text_field :author
            = f.label :author
          .input-field
            = f.text_area :body, { class: "materialize-textarea" }
            = f.label :body
          .input-field
            = f.submit "Submit Comment", { class: "btn waves-effect waves-light"}
    %br
    = link_to 'Edit', edit_task_path(@task), class: 'btn waves-effect waves-light'
    = link_to 'Back', tasks_path, class: 'btn waves-effect waves-light'
